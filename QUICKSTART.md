# LeapMailR - Quick Start Guide

**The fastest way to get LeapMailR running locally**

---

## âš¡ Quick Start (5 minutes)

### Option 1: Automated Setup (Recommended)

**Windows:**
```cmd
setup.bat
start.bat
```

**Linux/macOS:**
```bash
chmod +x setup.sh
./setup.sh
./start.sh
```

### Option 2: Using Make

```bash
make setup
make run
```

### Option 3: Manual Setup

```bash
# 1. Create config
cp config.env.example config.env

# 2. Setup database
createdb leapmailr

# 3. Install dependencies
go mod download

# 4. Run
go run .
```

---

## ğŸ“‹ Prerequisites

- **Go 1.23+** - [Download](https://go.dev/dl/)
- **PostgreSQL 14+** - [Download](https://www.postgresql.org/download/)
- **Redis 6+** (optional) - [Download](https://redis.io/download/)
- **Node.js 18+** (for frontend) - [Download](https://nodejs.org/)

---

## ğŸš€ Running the Application

### Backend

```bash
# Method 1: Using go run
go run .

# Method 2: Build and run
go build .
./leapmailr

# Method 3: Using Make
make run

# Method 4: Hot reload (requires air)
make dev
```

Backend will be available at:
- API: http://localhost:8080
- Health: http://localhost:8080/health
- Metrics: http://localhost:8080/metrics

### Frontend

```bash
cd ../leapmailr-ui
npm install
npm run dev
```

Frontend will be available at: http://localhost:3000

---

## ğŸ³ Docker Quick Start

```bash
cd docker-compose
docker-compose up -d
```

This starts:
- PostgreSQL (port 5432)
- Redis (port 6379)
- Backend API (port 8080)
- Frontend (port 3000)

---

## ğŸ› ï¸ Common Commands

### Development

```bash
make dev              # Run with hot reload
make test             # Run tests
make test-coverage    # Run tests with coverage
make lint             # Run linter
make fmt              # Format code
```

### Database

```bash
make db-create        # Create database
make db-drop          # Drop database
make db-reset         # Reset database
make backup           # Create backup
make restore BACKUP_FILE=./backups/file.sql.gz
```

### Docker

```bash
make docker-up        # Start all services
make docker-down      # Stop all services
make docker-logs      # View logs
make docker-restart   # Restart services
```

### Build

```bash
make build            # Build for current platform
make build-all        # Build for all platforms
make build-linux      # Build for Linux
make build-windows    # Build for Windows
make build-mac        # Build for macOS
```

---

## ğŸ“ Project Structure

```
leapmailr/
â”œâ”€â”€ config/           # Configuration management
â”œâ”€â”€ database/         # Database utilities
â”œâ”€â”€ handlers/         # HTTP handlers
â”œâ”€â”€ middleware/       # HTTP middleware
â”œâ”€â”€ models/           # Data models
â”œâ”€â”€ service/          # Business logic
â”œâ”€â”€ utils/            # Utility functions
â”œâ”€â”€ logging/          # Logging utilities
â”œâ”€â”€ scripts/          # Automation scripts
â”œâ”€â”€ docs/             # Documentation
â”œâ”€â”€ config.env        # Environment configuration
â”œâ”€â”€ main.go           # Application entry point
â”œâ”€â”€ Makefile          # Build automation
â””â”€â”€ setup.sh          # Setup script
```

---

## ğŸ”§ Configuration

Edit `config.env`:

```bash
# Server
PORT=8080
ENVIRONMENT=development

# Database
DB_HOST=localhost
DB_PORT=5432
DB_USER=leapmailr
DB_PASSWORD=your_password
DB_NAME=leapmailr

# Secrets (auto-generated by setup script)
JWT_SECRET=...
ENCRYPTION_KEY=...
```

---

## ğŸ§ª Testing

```bash
# Run all tests
make test

# Run with coverage
make test-coverage

# View coverage report
make coverage-html
open coverage.html

# Run specific package
go test ./handlers/...

# Run with verbose output
go test -v ./...
```

---

## ğŸ” Health Checks

```bash
# Backend health
curl http://localhost:8080/health

# Prometheus metrics
curl http://localhost:8080/metrics

# Database connection
psql -h localhost -U leapmailr -d leapmailr -c "SELECT 1"

# Redis connection
redis-cli ping
```

---

## ğŸ“Š Monitoring

### Prometheus Metrics

```bash
# View metrics
make metrics

# Or manually
curl http://localhost:8080/metrics
```

### Logs

```bash
# Tail application logs
make logs

# View specific log file
tail -f logs/application.log

# Search logs
grep "ERROR" logs/application.log
```

---

## ğŸš¢ Deployment

### Build for Production

```bash
# Build optimized binary
CGO_ENABLED=0 go build -ldflags="-w -s" -o leapmailr .

# Or using Make
make build-linux
```

### Deploy to Staging

```bash
make deploy-staging
```

### Deploy to Production

```bash
make deploy-prod
```

---

## ğŸ” Security

### Generate Secrets

```bash
# Encryption key (32 bytes)
openssl rand -base64 32

# JWT secret (64 characters)
openssl rand -base64 64 | tr -d "=+/" | cut -c1-64

# Database password (24 characters)
openssl rand -base64 24 | tr -d "=+/" | cut -c1-24
```

### Rotate Secrets

```bash
# Rotate all secrets
make secrets-rotate TYPE=all

# Rotate specific secret
make secrets-rotate TYPE=jwt
make secrets-rotate TYPE=database
```

---

## ğŸ› Troubleshooting

### Port Already in Use

```bash
# Find process using port 8080
lsof -i :8080                    # macOS/Linux
netstat -ano | findstr :8080     # Windows

# Kill process
kill -9 <PID>                    # macOS/Linux
taskkill /PID <PID> /F           # Windows
```

### Database Connection Failed

```bash
# Check PostgreSQL is running
pg_isready -h localhost -p 5432

# Test connection
psql -h localhost -U leapmailr -d leapmailr

# Check config
cat config.env | grep DB_
```

### Build Fails

```bash
# Clean cache
go clean -cache

# Update dependencies
go mod tidy
go mod download

# Verify modules
go mod verify
```

### Redis Connection Failed

```bash
# Check Redis is running
redis-cli ping

# Start Redis
redis-server                     # macOS/Linux
redis-server.exe                 # Windows
```

---

## ğŸ“š Documentation

- **[Complete Setup Guide](docs/SETUP_GUIDE.md)** - Comprehensive setup instructions
- **[Architecture](docs/ARCHITECTURE.md)** - System architecture overview
- **[API Documentation](docs/API.md)** - API endpoints and usage
- **[SOC 2 Compliance](docs/SOC2_COMPLIANCE.md)** - Security compliance details
- **[Secrets Management](docs/SECRETS_MANAGEMENT.md)** - Secret handling guide
- **[Disaster Recovery](docs/DISASTER_RECOVERY.md)** - Backup and recovery procedures

---

## ğŸ†˜ Getting Help

### View All Make Commands

```bash
make help
```

### Check Application Version

```bash
make version
```

### View Logs

```bash
make logs
```

### Health Check

```bash
make health
```

---

## ğŸ¯ Next Steps

1. **Configure Email Service** - Update SMTP settings in `config.env`
2. **Setup Frontend** - Follow frontend setup in `../leapmailr-ui`
3. **Enable MFA** - Multi-factor authentication is ready to use
4. **Configure Monitoring** - Setup Prometheus and Grafana
5. **Review Security** - Read `docs/SECRETS_MANAGEMENT.md`
6. **Setup CI/CD** - Configure GitHub Actions or GitLab CI
7. **Deploy** - Follow deployment guide for your platform

---

## ğŸ“ Environment Variables Reference

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `PORT` | Server port | 8080 | No |
| `ENVIRONMENT` | Environment mode | development | No |
| `DB_HOST` | Database host | localhost | Yes |
| `DB_PORT` | Database port | 5432 | Yes |
| `DB_USER` | Database user | leapmailr | Yes |
| `DB_PASSWORD` | Database password | - | Yes |
| `DB_NAME` | Database name | leapmailr | Yes |
| `JWT_SECRET` | JWT signing key | - | Yes |
| `ENCRYPTION_KEY` | AES encryption key | - | Yes |
| `REDIS_HOST` | Redis host | localhost | No |
| `REDIS_PORT` | Redis port | 6379 | No |
| `FRONTEND_URL` | Frontend URL | http://localhost:3000 | Yes |

See `config.env` for complete list.

---

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests: `make test`
5. Run checks: `make check`
6. Submit a pull request

---

## ğŸ“„ License

See [LICENSE](LICENSE) file for details.

---

## ğŸ”— Links

- **Backend Repository**: https://github.com/dhawalhost/leapmailr
- **Frontend Repository**: https://github.com/dhawalhost/leapmailr-ui
- **Documentation**: [docs/](docs/)
- **Issues**: https://github.com/dhawalhost/leapmailr/issues

---

**Built with â¤ï¸ by the LeapMailR Team**
